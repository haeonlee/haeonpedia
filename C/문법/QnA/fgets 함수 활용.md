작성일: 2022. 08. 07

책 <혼자 공부하는 C언어>에서 18장 fgets 함수를 while문에서 넣어서 반복했는데, 어떻게 이런 알고리즘이 가능한 건지 이해가 안 됐습니다. (i 값이 바뀌는 것도 아닌데?) fgets 함수에서 반환한다는 배열의 주소 값이 어떤 식으로 작용하는지 알기 위해서 이 문서를 작성합니다.

---

# 문제 코드

``` c
while (1)
{
    res = fgets(str, sizeof(str), ifp);
    if (res == NULL)
    {
        break;
    }
    str[strlen(str) - 1] = '\0';
    fputs(str, ofp);
    fputs(" ", ofp);
}
```

- fgets 함수의 인수로 있는, 파일 포인터 ifp는 a.txt와 연결돼 있습니다. a.txt는 총 세 줄로 구성된 텍스트 파일입니다.
- 근데, fgets 함수는 res라는 char 포인터 변수랑 연동돼 있는데, 도대체 어떻게 여러 줄을 순서대로 출력할 수 있을까요?

# fgets 함수 분석


fgets 함수: 데이터를 한 줄씩 입력할 때 사용

    읽을 데이터의 크기가 큰 경우 저장 공간의 크기까지만 입력할 수 있으므로,
    할당하지 않은 메모리를 침범할 가능성을 차단합니다.

    (1) fgets 함수 입력 방법
    fgets(str, sizeof(str), ifp);
    fgets(입력할 배열, 배열의 크기, 파일 포인터);

    문자열을 저장할 배열과 그 크기를 주고, 입력할 파일의 포인터를 줍니다.

    (2) fgets 함수가 입력을 마치면 입력한 배열의 주소를 다시 반환합니다.
    이를 활용하면 함수를 호출한 후에 바로 입력된 데이터를 사용할 수 있어 편리합니다.
    
    (3) fgets 함수는 파일에서 더 이상 읽을 데이터가 없으면 NULL을 반환합니다.
    fgets 함수를 호출할 때 파일의 끝을 검사하기 위해서는 NULL과 비교해야 합니다.
    EOF(-1)를 사용하지 않도록 주의합시다.

반환 값에 특별한 비밀이 있나 싶었는데(e.g. 다음 줄의 위치를 알려 준다든지) 그냥 입력 받은 배열 값의 주소를 그대로 내보낸다는 걸 알았다. 여러 문서를 읽어 봤지만, 특별히 궁금증이 해소되진 않았고... 어차피 버퍼에 입력된 값을 읽는 셈이니까 버퍼에서 하나씩 없애가는 것이 아닐까 싶다.
